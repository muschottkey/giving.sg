AUI.add("liferay-dockbar",function(q){var s=q.Object;var g=q.Lang;var h=Liferay.Util;var t=q.getBody();var l="lfr-has-add-content";var p="lfr-has-edit-layout";var v="dockbar-item";var f="lfr-has-device-preview";var n="click";var b=".nav-account-controls";var d=".nav-add-controls";var e="addPanel";var u="editLayoutPanel";var k="previewPanel";var c='<div class="lfr-add-panel lfr-admin-panel" id="{0}" />';var o='<div class="lfr-admin-panel lfr-edit-layout-panel" id="{0}" />';var j='<div class="lfr-admin-panel lfr-device-preview-panel" id="{0}" />';var m='<div class="loading-animation" />';var a={init:function(x){var w=this;var z=q.one(x);if(z){w.dockBar=z;w._namespace=z.attr("data-namespace");Liferay.once("initDockbar",w._init,w);var y=z.on(["focus","mousemove","touchstart"],function(B){var C=B.target;var A=B.type;Liferay.fire("initDockbar");y.detach();if(themeDisplay.isSignedIn()&&!q.UA.touch){w._initInteraction(C,A)}});t.addClass("dockbar-ready");Liferay.on(["noticeHide","noticeShow"],w._toggleControlsOffset,w)}},getPanelNode:function(z){var w=this;var y=null;var x=i[z];if(x){y=x.node;if(!y){var A=w._namespace;var B=A+z+"Sidebar";y=q.one("#"+B);if(!y){y=q.Node.create(g.sub(x.tpl,[A]));y.plug(q.Plugin.ParseContent);t.prepend(y);y.set("id",B);x.node=y}}}return y},togglePreviewPanel:function(){var w=this;a._togglePanel(k)},toggleAddPanel:function(){var w=this;a._togglePanel(e)},toggleEditLayoutPanel:function(){var w=this;a._togglePanel(u)},_registerPanels:function(){var w=this;var x=w._namespace;s.each(i,function(B,y,C){var z=B.id;var A=q.one("#"+x+z);if(A){A.on(n,function(D){D.halt();w._togglePanel(z)})}})},_setLoadingAnimation:function(x){var w=this;w.getPanelNode(x).html(m)},_toggleAppShortcut:function(x,y){var w=this;x.toggleClass("lfr-portlet-used",y);w._addContentNode.focusManager.refresh()},_toggleControlsOffset:function(z){if(!z.useAnimation){var w=this;var A=false;if(z.type==="noticeShow"){A=true}var y=w._namespace;var B=q.one("#"+y+"navAccountControls");if(B){B.toggleClass("nav-account-controls-notice",A)}var x=q.one("#"+y+"navAddControls");if(x){x.toggleClass("nav-add-controls-notice",A)}}},_togglePanel:function(A){var w=this;s.each(i,function(D,C,E){if(D.id!==A){t.removeClass(D.css);if(D.node){D.node.hide();t.detach("layoutControlsEsc|key")}}});var y=i[A];if(y){var z=y.node;if(!z){z=w.getPanelNode(y.id)}t.toggleClass(y.css);var B="dockbarHidePanel";var x=false;if(z&&t.hasClass(y.css)){y.showFn(A);B="dockbarShowPanel";x=true;t.on("layoutControlsEsc|key",function(E){if(A!==k){w._togglePanel(A)}var C=q.one("#"+w._namespace+"navAddControls");if(C){var D;if(A==e){D=C.one(".site-add-controls > a")}else{if(A==u){D=C.one(".page-edit-controls > a")}else{if(A==k){D=C.one(".page-preview-controls > a")}}}if(D){D.focus()}}},"down:27")}Liferay.fire("dockbaraddpage:previewPageTitle",{data:{hidden:true}});Liferay.fire(B,{id:A});if(!x){t.detach("layoutControlsEsc|key")}z.toggle(x)}}};Liferay.provide(a,"_init",function(){var x=this;var A=x.dockBar;var z=x._namespace;Liferay.Util.toggleControls(A);x._toolbarItems={};Liferay.fire("initLayout");Liferay.fire("initNavigation");x._registerPanels();var y=q.oneNS(z,"#navSiteNavigationNavbarBtn");var w=q.one(Liferay.Data.NAV_SELECTOR);if(y&&w){y.on(n,function(B){y.toggleClass("open");w.toggleClass("open")})}Liferay.fire("dockbarLoaded")},["aui-io-request","liferay-node","liferay-store","node-focusmanager"]);Liferay.provide(a,"_initInteraction",function(C,D){var F=this;var A=F.dockBar;var y=A.one(b);var E=A.one(d);if(y){var z=y.one(".staging-bar");if(z){z.all("> li").addClass(v)}y.all("> li > a").get("parentNode").addClass(v)}if(t.hasClass("dockbar-split")){if(y){y.plug(Liferay.DockbarKeyboardInteraction)}if(E){E.plug(q.Plugin.NodeFocusManager,{circular:true,descendants:"li a",keys:{next:"down:39,40",previous:"down:37,38"}});E.focusManager.after("focusedChange",function(H){var G=this;if(!H.newVal){G.set("activeDescendant",0)}})}}else{if(E){var x=A.one(".brand");if(x){x.all("a").get("parentNode").addClass(v)}E.all("> li").addClass(v);A.plug(Liferay.DockbarKeyboardInteraction)}}if(D==="focus"){var B=C.ancestor(b);var w=C;if(B){w=B.one("li a")}w.blur();w.focus()}},["liferay-dockbar-keyboard-interaction","node-focusmanager"]);Liferay.provide(a,"_showPanel",function(y){var w=this;w._setLoadingAnimation(y);var x=q.one("#"+w._namespace+y);if(x){var z=x.ancestor().attr("data-panelURL");q.io.request(z,{after:{success:function(C,E,D){var B=this.get("responseData");var A=w.getPanelNode(y);A.plug(q.Plugin.ParseContent);A.setContent(B)}}})}},["aui-io-request","aui-parse-content","event-outside"]);var r=q.bind("_showPanel",a);var i={addPanel:{css:l,id:e,node:null,showFn:r,tpl:c},editLayoutPanel:{css:p,id:u,node:null,showFn:r,tpl:o},previewPanel:{css:f,id:k,node:null,showFn:r,tpl:j}};Liferay.Dockbar=a;Liferay.Dockbar.ADD_PANEL=e;Liferay.Dockbar.PREVIEW_PANEL=k},"",{requires:["aui-node","aui-overlay-mask-deprecated","event-touch"]});